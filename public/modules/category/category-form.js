document.addEventListener("DOMContentLoaded",(function(){var e,t=document.getElementById("categoryOffcanvas");if(t){var r=new bootstrap.Offcanvas(t),o=document.getElementById("category-form");if(o){var n=o,a=document.getElementById("name"),l=document.getElementById("parent_id"),s=null===(e=document.querySelector('meta[name="baseUrl"]'))||void 0===e?void 0:e.getAttribute("content");if(s){var c=t.querySelector(".offcanvas-title");if(c){var i=document.getElementById("parent_id"),d=document.querySelector(".category-status");u(),t.addEventListener("show.bs.offcanvas",(function(e){var t=e.relatedTarget;if(t&&t.matches('[data-bs-target="#categoryOffcanvas"]')){if(!n)return void console.error("Category form element not found in offcanvas show event");var r=t.dataset.type;c&&(c.textContent="subcategory"===r?"New Subcategory":"New Category"),n.reset();var a=n.querySelector("#name");a&&(a.value="");var l=n.querySelector("#status");l&&(l.checked=!0),n&&n.querySelectorAll(".fields-error").forEach((function(e){e.textContent="",e.classList.add("d-none")}));var i=n.querySelector(".upload-image-box img"),d=o?o.querySelector(".upload-image-box button.btn-danger"):null;i&&(i.src=i.dataset.defaultSrc,d&&(d.style.display="none"));var f=n.querySelector('input[name="_method"]');f&&f.remove(),n&&n.querySelectorAll("select").forEach((function(e){e.value="",$(e).hasClass("select2")&&$(e).val("").trigger("change")})),setTimeout((function(){u()}),100),n.action="".concat(s,"/app/categories"),o&&(o.action=n.action)}})),document.addEventListener("click",(function(e){var t,l,u=e.target.closest("[data-category-id]"),f=e.target.closest("[data-subcategory-id]");(u||f)&&(n?(u?(t=u.dataset.categoryId,l="category"):(t=f.dataset.subcategoryId,l="subcategory"),n?(n&&n.querySelectorAll(".fields-error").forEach((function(e){e.textContent="",e.classList.add("d-none")})),fetch("".concat(s,"/app/categories/").concat(t,"/edit"),{headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(e){if(n)if(e.status&&e.data){c&&(c.textContent="subcategory"===l?"Edit Subcategory":"Edit Category"),a&&(a.value=e.data.name||""),d&&(d.checked=1===Number(e.data.status)),"subcategory"===l&&i&&(i.value=e.data.parent_id||"",$(i).trigger("change")),n.action="".concat(s,"/app/categories/").concat(t);var u=n.querySelector('input[name="_method"]');u||((u=document.createElement("input")).type="hidden",u.name="_method",n.appendChild(u)),u.value="PUT",o&&(o.action=n.action);var f=e.data.feature_image,g=o?o.querySelector(".upload-image-box img"):null,m=o?o.querySelector(".upload-image-box button.btn-danger"):null;g&&(f?(g.src=f,m&&(f.includes("default.png")?m.style.display="none":m.style.display="inline-block")):(g.src=g.dataset.defaultSrc,m&&(m.style.display="none"))),r&&r.show()}else console.error("Unexpected response:",e);else console.error("Category form element not found in fetch response handler")})).catch((function(e){return console.error("Error fetching category:",e)}))):console.error("Category form element not found when trying to edit")):console.error("Category form element not found when trying to edit"))})),a&&(a.addEventListener("input",(function(){this.value.trim()&&g(this)})),a.addEventListener("blur",(function(){var e=this.value.trim();e?/[!@#$%^&*(),.?":{}|<>\-_;'\/+=\[\]\\]/.test(e)||/\d/.test(e)?f(this,"Only strings are allowed"):g(this):f(this,"Name is a required field")}))),l&&(l.addEventListener("change",(function(){this.value.trim()&&g(this)})),$(l).length&&$(l).hasClass("select2-hidden-accessible")&&$(l).on("change",(function(){$(this).val()&&g(this[0])}))),o&&o.addEventListener("submit",(function(e){var t=!0;if(o&&o.querySelectorAll(".form-group .form-control, .form-group .form-select").forEach((function(e){return g(e)})),a){var r=a.value.trim();r?(/[!@#$%^&*(),.?":{}|<>\-_;'\/+=\[\]\\]/.test(r)||/\d/.test(r))&&(f(a,"Only strings are allowed"),t=!1):(f(a,"Name is a required field"),t=!1)}l&&(l.value.trim()||(f(l,"Category is a required field"),t=!1)),t||e.preventDefault()}))}else console.error("Category offcanvas title element not found")}else console.error("Base URL meta tag not found")}else console.error("Category form element not found")}else console.error("Category offcanvas element not found");function u(){$("#parent_id").length&&!$("#parent_id").hasClass("select2-hidden-accessible")&&$("#parent_id").select2({placeholder:"Select Category",allowClear:!1,width:"100%",minimumResultsForSearch:1/0}).on("change",(function(){var e=$(this).val(),t=$(this)[0];e&&t&&g(t)}))}function f(e,t){var r=e.closest(".form-group").querySelector(".fields-error");r&&(r.textContent=t,r.classList.remove("d-none"))}function g(e){var t=e.closest(".form-group");if(t){var r=t.querySelector(".fields-error");r&&(r.textContent="",r.classList.add("d-none"))}}})),window.previewImage=function(e){var t=new FileReader;t.onload=function(){var r=e.target.closest(".form-group"),o=null==r?void 0:r.querySelector("img");o&&(o.src=t.result);var n=null==r?void 0:r.querySelector(".btn-danger");n&&(n.style.display="inline-block")},t.readAsDataURL(e.target.files[0])},window.removeImage=function(e){var t=e.target.closest(".form-group"),r=null==t?void 0:t.querySelector("img"),o=null==t?void 0:t.querySelector('input[type="file"]'),n=e.target;r&&(r.src=r.dataset.defaultSrc),o&&(o.value=""),n&&(n.style.display="none")};
//# sourceMappingURL=category-form.js.map